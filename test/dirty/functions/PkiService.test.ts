import { describe, it, expect, beforeEach } from 'vitest';
import {PkiService} from "@src/dirty/functions/PkiService";

describe('PkiServiceTest', () => {
  let sut: PkiService;

  beforeEach(() => {
    sut = new PkiService();
  });

  it('createSignedCertificateForCsrOK', () => {
    // given
    const csrAsBase64 = "LS0tLS1CRUdJTiBDRVJUSUZJQ0FURSBSRVFVRVNULS0tLS0KTUlJRXZqQ0NBcVlDQVFBd2VURUxNQWtHQTFVRUJoTUNSRVV4Q3pBSkJnTlZCQWdNQWs1WE1STXdFUVlEVlFRSApEQXBNWVc1blpXNW1aV3hrTVFzd0NRWURWUVFLREFKQ1V6RUxNQWtHQTFVRUN3d0NTVlF4TGpBc0JnTlZCQU1NCkpXTnZibTVsZUhRdGNHOWpMV05zYVdWdWRDMWpaWEowTFhObGNuWnBZMlV1Ykc5allXd3dnZ0lpTUEwR0NTcUcKU0liM0RRRUJBUVVBQTRJQ0R3QXdnZ0lLQW9JQ0FRQ1JTR0VkTUpVWXdiSFJYUGVLbmNpT3JUM3lMT3NZU0dhUQpuSDg4YkNBNGdsR3FiNlJpY2VvajZ1bzhCMXc5WFl1aFB4RmxyQi9idjVOTTdTbVQ3T0dDQlZKOE9mN2xPOXZGCk1SdW5Bb1RKdnNuOVhnckpRS21hK2RtMlpGVWViOWJWUWxqc3RsN1Nlem5OV0t6MHRFV0VFZVFUY0VJeEhscFcKMjdPZGNpcXkvREhNSW0rYlozZ0NKT0lvZzhkQ2lDQWg0c0dYVm9nSmk2bzV2QTFZQis4T2tsNnZIY29PaFRQMgp1T3Z2R0trUzAwTzNjbTVVNSs4dUwrNkRCUlBCY2YvYmpDSUx5L0pCSkUveUZrWUFNWkZOeGkxcGZDZFFQa2d3Cldya3c2aS8rb1FUQkExb1ZqaXo5cGNuWEpmbHNhdDFUbEU4MTdGdmNKbmNjU3RyWVVIYXh2a0IzczB0WWxqemkKT3BMdmNKZUdFdVFXQXpyTWZpSlpvVHNUM0JabVJDa3JGQ1NhRWdtS3F0dmxtVllLakZCZEVEQS8rdzhyMm1ieApuTGVFdEl5Y2pyN2k5YUtTeHM3SUYzNnl4OFlrNHNPOEEyOUR5bSs1RkJJcVNleHRVOURsYkc2c3RSVjQ3Y21oClpYVjNkUXRYWFNXQnJBUzF5VHFDb0dqb3pwWkhoUytYdnFPenRHOXRpM0VIRitrT2hTTk5UZ3NkODJsVEFXODQKMHJCMmNRZWZ6Y0Y0QUx3bStXWk9aaGU1N1hEcGNVamdBUmQ3NlB5Nzk1dDVudjdCWWJsTkk0R0RPdytmVGluQgpqa0R0R2hLQ2JaTHJNTzN5N3h6SExlN3ZVeER0aGtLdVJzZENkZkI3OW8rNGJ0d0ovYnM1TktuY1Aza2JMaWFFCjN2ZlhlOGQ0TlFJREFRQUJvQUF3RFFZSktvWklodmNOQVFFTEJRQURnZ0lCQUlkWnBwMlhnSGQzbFBSMjU1Z2oKUVRmdnc3QmovWTdjK2VPUGJKNDV6U3l4dzZvK2ZUNzhTY1h1SGwxLzBiZXdGWHgrMUF6amFQYjdVNnIzSXJpaAoraWFOREQwRkxFb2tHOUJFR1N6N1BMNUdTTlppT1UxRk5hWUY4dVp5VE9YejVMYUk3T0hXSGRJSHVGSzRkdzgzCjBuYW00SlhQMEJpSGx3WGd4S3dJVnk0aXFPVHlOUHFuRi8vTlRjM2gzeDEzNm9FMGdBRWphcXJGMGVUWDhRSW0KOGFMSlhacDhZZ3hnQ2FTTTlHZWxvYU1RWHFtMUZiVzRXZUtudVZORzZQS1E4TURZTmRTWHRkMFo3YkU3b00yVQpMUVduSzR4eTk5MFlVejl5d1FSNEhIb1RTRnlrVytON05ETFJ1MFlCdk03V1hCRnJhb3RPYWpHMkhBRnoyL0VzCkx5c3kva0pEbUgyRFh2ZGxZVkc3d0ZXS1RVdC9ZcVBBZE9PeFN0L0ZDbm10Y1NBMkhMVkROd0tuYkZmaU9vcmEKTzA5VGtCQlJoOTl1elFIWmI1UkpvMTA4MDRONU5FRXFhV05mQXl4NVVUQndLWlRCVlNFUXRNc0NrbG0rbnZBcAp0elE1d09WeHhVUGt6VjF1SnZsU1lJT2FyOFQyTitRRG40azVWa2tnbE1BeHRnc0lGRy9TQ1VXZXk3eXRlT0pSClVLb1RPWTZnUmxNN1ljZXJDZG1BTStYWEpERkg3NEtOU0xKSGlvOHNRbWdoc2FFMlJWZkora1ZBZVJsc1pBL3oKL29oNDdpUnp1MmZDZmlWak1weHp4RDBOcTVYTmpoS21MVGlNc2NtTjQ1N1BGY3IvbnVUOUVHbm5KR3J6cjM0VQp2dkdudTh6NkZ3LytoZ3JZSTIwdGNvZ04KLS0tLS1FTkQgQ0VSVElGSUNBVEUgUkVRVUVTVC0tLS0tCg==";
    const notBefore = new Date("2024-12-01");
    const notAfter = new Date("2025-11-30");
    const type = "apps";
    const uid = "p123";

    // when
    const actual = sut.createSignedCertificateForCsr(csrAsBase64, notBefore, notAfter, type, uid);

    // then
    expect(actual).toEqual("LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUdHRENDQkFDZ0F3SUJBZ0lVWTduQ0tVSk5Gd1paQkxJcTVKMmxzM0FEc2J3d0RRWUpLb1pJaHZjTkFRRUwKQlFBd2F6RUxNQWtHQTFVRUJoTUNSRVV4RERBS0JnTlZCQWdNQTA1U1Z6RU1NQW9HQTFVRUJ3d0RRa2RNTVJFdwpEd1lEVlFRS0RBaE5hV3gwWlc1NWFURUxNQWtHQTFVRUN3d0NZMkV4SURBZUJnTlZCQU1NRjJsdWRHVnliV1ZrCmFXRjBaUzFqWVMxelpYSjJaWEp6TUI0WERUSTBNVEF4T0RFME1qUTFOVm9YRFRJMU1UQXhPREUwTWpRMU5Wb3cKZVRFTE1Ba0dBMVVFQmhNQ1JFVXhDekFKQmdOVkJBZ01BazVYTVJNd0VRWURWUVFIREFwTVlXNW5aVzVtWld4awpNUXN3Q1FZRFZRUUtEQUpDVXpFTE1Ba0dBMVVFQ3d3Q1NWUXhMakFzQmdOVkJBTU1KV052Ym01bGVIUXRjRzlqCkxXTnNhV1Z1ZEMxalpYSjBMWE5sY25acFkyVXViRzlqWVd3d2dnSWlNQTBHQ1NxR1NJYjNEUUVCQVFVQUE0SUMKRHdBd2dnSUtBb0lDQVFDUlNHRWRNSlVZd2JIUlhQZUtuY2lPclQzeUxPc1lTR2FRbkg4OGJDQTRnbEdxYjZSaQpjZW9qNnVvOEIxdzlYWXVoUHhGbHJCL2J2NU5NN1NtVDdPR0NCVko4T2Y3bE85dkZNUnVuQW9USnZzbjlYZ3JKClFLbWErZG0yWkZVZWI5YlZRbGpzdGw3U2V6bk5XS3owdEVXRUVlUVRjRUl4SGxwVzI3T2RjaXF5L0RITUltK2IKWjNnQ0pPSW9nOGRDaUNBaDRzR1hWb2dKaTZvNXZBMVlCKzhPa2w2dkhjb09oVFAydU92dkdLa1MwME8zY201VQo1Kzh1TCs2REJSUEJjZi9iakNJTHkvSkJKRS95RmtZQU1aRk54aTFwZkNkUVBrZ3dXcmt3NmkvK29RVEJBMW9WCmppejlwY25YSmZsc2F0MVRsRTgxN0Z2Y0puY2NTdHJZVUhheHZrQjNzMHRZbGp6aU9wTHZjSmVHRXVRV0F6ck0KZmlKWm9Uc1QzQlptUkNrckZDU2FFZ21LcXR2bG1WWUtqRkJkRURBLyt3OHIybWJ4bkxlRXRJeWNqcjdpOWFLUwp4czdJRjM2eXg4WWs0c084QTI5RHltKzVGQklxU2V4dFU5RGxiRzZzdFJWNDdjbWhaWFYzZFF0WFhTV0JyQVMxCnlUcUNvR2pvenBaSGhTK1h2cU96dEc5dGkzRUhGK2tPaFNOTlRnc2Q4MmxUQVc4NDByQjJjUWVmemNGNEFMd20KK1daT1poZTU3WERwY1VqZ0FSZDc2UHk3OTV0NW52N0JZYmxOSTRHRE93K2ZUaW5CamtEdEdoS0NiWkxyTU8zeQo3eHpITGU3dlV4RHRoa0t1UnNkQ2RmQjc5bys0YnR3Si9iczVOS25jUDNrYkxpYUUzdmZYZThkNE5RSURBUUFCCm80R2xNSUdpTUFrR0ExVWRFd1FDTUFBd0RnWURWUjBQQVFIL0JBUURBZ1dnTUJNR0ExVWRKUVFNTUFvR0NDc0cKQVFVRkJ3TUJNREFHQTFVZEVRUXBNQ2VDSldOdmJtNWxlSFF0Y0c5akxXTnNhV1Z1ZEMxalpYSjBMWE5sY25acApZMlV1Ykc5allXd3dIUVlEVlIwT0JCWUVGUFV5OHlFejdBT3h4ZW12TU1taENvTUxpSnhVTUI4R0ExVWRJd1FZCk1CYUFGRlNoTlFuK2lwRnhIQUpiMWdUMGNIdGMzSVhMTUEwR0NTcUdTSWIzRFFFQkN3VUFBNElDQVFCdzdKSGYKZ1RjYkc4aXg4a2NoY2thQUI5dXlleDhxem1BRzBGVFpwZ3d1WUNjV2Q5RXRBNkpqZWVuWnJrOTMxZ05KNFcwTAprdEV6NmhUVnFJd1MxSG9Ec3kvYks3ZXVWZlUwQzdETDh4MHpTdFE0d1Byd2ZIUWtacmF3NXZmTmt1TTU2QmZBCnBkOGM0aStUOHNrN3RyNndHaCtjSHZ3S1dSNkh0M2ZTU1ZwVVBhYjNKSVZEUVowcXZuN2loSDBnWkpOQnFzNm8KejlMemVQM002cy9KaE5BVmNmWFg0SHNFcW9FaGNSa3AwK0hheDQzMHByaVYxSVdmZ25POUQxN1QrU0xGK1IzMgpyZTdVQmpqSjlNclZ0UjZLeWdwTkp2dW5adVVmSXF0SFdGQ1VuSG01UVlaSWc3alA1OVd4UmZ3Zml0NDhZdU9CCkxrdUtPbGxTMkZ0Y2dtcDNhaTlPYTZJYlNOWkpMZkVnTU9yVE0zM2lYcWZ0Snllb3lnRzRTaU5wRm1rWWZBUE4KVUVxb0t5RG1QWjV2Rzd2Ri9YNldoWFhTSTVnbkJqUDB5RUxTUGNaVFMrSW10Mmp5TEVLRmYwdWFKQkYzc3REQQpTVEQya1l2Z2JubTVhdGo5QUNyYVpkcW1VL016b3dBaHlpdzdKNDBhY1hwSzZnY0hTU3FOVUkrb2t0Zzh5SlFzClpGdVRtVzBuV05id2JQc2kwd3ZiNG9kMWk0RWtyMlBMQTk0NXRQT2hRZnJFOEd3bHhwRFU3Tis4Q3E1RzQ0aUIKalF2UklkWlBnanEzV3VvRFhobGt4K21MU29MTkRtVm5saUFzd3FLSDV1WEpmellOZmY1NGpRSXlvR2hxK2cydQo5bUdNTERpaFBrSzhQWGgzVC9zTlFDQTNlNUhLcml2K091UmJPUT09Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K");
  });
});